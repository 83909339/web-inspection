# Web系统巡检助手 - 用户手册

## 目录
1. [安装说明](#安装说明)
2. [功能介绍](#功能介绍)
3. [配置指南](#配置指南)
4. [使用步骤](#使用步骤)
5. [巡检报告生成](#巡检报告生成)
6. [常见问题](#常见问题)
7. [技术支持](#技术支持)

---

## 安装说明

### 系统要求
- Chrome浏览器 88+ 或 Edge浏览器 88+
- Windows 10/11 或 macOS 10.14+ 或 Linux

### 安装步骤

#### 方法一：开发者模式安装（推荐）

1. **打开Chrome浏览器**
2. **访问扩展管理页面**
   - 在地址栏输入：`chrome://extensions/`
   - 或点击浏览器右上角的三个点 → 更多工具 → 扩展程序

3. **启用开发者模式**
   - 在扩展管理页面右上角打开"开发者模式"开关

4. **加载插件**
   - 点击"加载已解压的扩展程序"
   - 选择插件文件夹（包含manifest.json的文件夹）
   - 点击"选择文件夹"

5. **验证安装**
   - 浏览器右上角应该出现插件图标
   - 点击图标，弹出插件界面表示安装成功

#### 方法二：crx文件安装

1. **下载crx文件**（如果提供）
2. **拖拽安装**
   - 打开Chrome扩展管理页面
   - 将crx文件拖拽到页面中
   - 点击"添加扩展程序"确认安装

---

## 功能介绍

### 核心功能
- **接口巡检**：自动调用预设接口，检查返回状态和数据
- **页面巡检**：自动访问预设页面，检查可访问性和错误
- **智能告警**：支持自定义告警规则，异常时自动通知
- **定时巡检**：支持设置巡检间隔，自动周期性执行
- **截图功能**：可选择性对页面进行截图，便于问题诊断
- **报告生成**：生成详细的巡检报告，可直接复制到Word

### 特色功能
- **Cookie保持**：自动携带登录状态，支持需要认证的系统
- **性能监控**：收集页面加载时间、响应时间等性能指标
- **错误监控**：自动监听JavaScript错误和资源加载失败
- **本地存储**：所有数据本地保存，确保隐私安全

---

## 配置指南

### 首次使用配置

1. **点击插件图标**
   - 在浏览器右上角点击插件图标
   - 初次使用会看到空白配置页面

2. **配置接口巡检**
   - 点击"添加接口"按钮
   - 填写接口信息：
     - **接口名称**：易于识别的名称（如"用户列表接口"）
     - **接口URL**：完整的接口地址
     - **请求方法**：GET/POST等
     - **告警规则**：JavaScript表达式（可选）

3. **配置页面巡检**
   - 点击"添加页面"按钮
   - 填写页面信息：
     - **页面名称**：易于识别的名称（如"用户管理页面"）
     - **页面URL**：完整的页面地址
     - **启用截图**：是否需要截图

4. **设置巡检间隔**
   - 在"巡检设置"区域选择间隔时间
   - 支持30分钟、1小时、2小时、4小时

### 接口配置详解

#### 基本信息
- **接口名称**：用于识别和报告中显示
- **接口URL**：必须是完整的URL，包含协议（https://）
- **请求方法**：支持GET、POST、PUT、DELETE

#### 告警规则示例
告警规则使用JavaScript表达式，`response`变量包含接口返回的数据：

```javascript
// 检查返回码
response.code != 0

// 检查数据是否为空
response.data.length === 0

// 检查特定字段
response.success !== true

// 组合条件
response.code != 0 || response.data.length === 0

// 检查嵌套数据
response.result && response.result.status === 'error'
```

### 页面配置详解

#### 基本信息
- **页面名称**：用于识别和报告中显示
- **页面URL**：必须是完整的URL，包含协议（https://）
- **启用截图**：勾选后会在巡检时自动截图

#### 截图说明
- 截图会保存在巡检结果中
- 截图格式为JPEG，质量为70%
- 截图会包含在生成的报告中
- 截图数据存储在本地，不会上传

---

## 使用步骤

### 1. 准备工作
1. **登录目标系统**
   - 在浏览器中正常登录需要巡检的系统
   - 确保Cookie和登录状态有效

2. **配置巡检项**
   - 按照配置指南添加接口和页面
   - 设置合适的告警规则

### 2. 开始巡检
1. **手动启动**
   - 点击插件图标打开界面
   - 在"配置管理"标签页点击"开始巡检"
   - 状态指示器会显示"巡检中"

2. **查看结果**
   - 切换到"巡检结果"标签页
   - 查看最近的巡检结果
   - 成功和失败的统计信息

### 3. 监控告警
1. **浏览器通知**
   - 发现异常时会在浏览器右上角显示通知
   - 通知包含异常类型和简要信息

2. **状态查看**
   - 在巡检结果页面查看详细错误信息
   - 红色标记表示失败，绿色表示成功

### 4. 停止巡检
1. **手动停止**
   - 点击"停止巡检"按钮
   - 状态指示器会显示"已停止"

---

## 巡检报告生成

### 生成报告

1. **切换到报告标签页**
   - 点击"生成报告"标签

2. **选择报告选项**
   - **包含截图**：勾选后报告中会包含页面截图
   - **包含错误详情**：勾选后会显示详细错误信息

3. **生成报告**
   - 点击"生成报告"按钮
   - 等待报告生成完成

### 使用报告

1. **复制报告**
   - 点击"复制报告"按钮
   - 报告会复制到剪贴板，保持HTML格式

2. **粘贴到Word**
   - 打开Microsoft Word
   - 按Ctrl+V粘贴
   - 表格格式和图片会自动保持

3. **预览报告**
   - 点击"预览"按钮可在新窗口中查看报告
   - 便于确认格式和内容

### 报告内容说明

报告包含以下信息：
- **报告时间**：生成报告的时间
- **巡检项目列表**：表格形式展示所有巡检项
- **状态统计**：成功/失败数量统计
- **详细信息**：每个项目的具体结果

表格列说明：
- **类型**：接口或页面
- **名称**：配置时设置的名称
- **URL**：巡检的地址
- **状态**：成功或失败
- **耗时**：响应时间（毫秒）
- **时间**：巡检执行时间
- **错误详情**：失败时的错误信息（可选）
- **截图**：页面截图（可选）

---

## 常见问题

### Q1：插件无法加载
**A1：** 
- 确保浏览器版本满足要求
- 检查是否启用了开发者模式
- 重新加载插件或重启浏览器

### Q2：接口巡检失败
**A2：**
- 检查接口URL是否正确
- 确认登录状态是否有效
- 检查网络连接是否正常
- 查看告警规则是否正确

### Q3：页面巡检失败
**A3：**
- 确认页面URL可以正常访问
- 检查是否需要登录权限
- 确认页面加载时间是否过长（超过60秒会超时）

### Q4：无法生成报告
**A4：**
- 确保至少执行过一次巡检
- 检查浏览器是否允许剪贴板访问
- 尝试刷新页面后重新生成

### Q5：截图功能不工作
**A5：**
- 确保浏览器允许插件访问标签页
- 检查页面是否存在跨域限制
- 确认插件权限设置正确

### Q6：告警规则不生效
**A6：**
- 检查JavaScript语法是否正确
- 确认response变量路径是否正确
- 在浏览器控制台测试表达式

---

## 技术支持

### 调试方法

1. **查看插件日志**
   - 打开Chrome开发者工具
   - 切换到"Console"标签页
   - 查看是否有错误信息

2. **检查插件状态**
   - 访问`chrome://extensions/`
   - 找到本插件，点击"详细信息"
   - 查看"检查视图"中的错误

3. **测试接口**
   - 使用Postman或浏览器开发者工具
   - 手动测试接口是否正常
   - 检查返回数据格式

### 性能优化建议

1. **合理设置巡检间隔**
   - 根据系统重要性设置间隔
   - 避免过于频繁的巡检

2. **限制巡检项目数量**
   - 单次巡检建议不超过20个项目
   - 优先配置关键接口和页面

3. **优化告警规则**
   - 使用简单的判断条件
   - 避免复杂的计算逻辑

### 数据存储说明

- **配置数据**：存储在`chrome.storage.sync`中，会同步到用户的Chrome账户
- **结果数据**：存储在`chrome.storage.local`中，仅在本地保存
- **最大存储**：保留最近100条巡检结果
- **数据安全**：所有数据仅在本地存储，不会上传到任何服务器

### 隐私保护

- 插件不会收集任何用户数据
- 不会上传巡检结果或配置信息
- 不会跟踪用户行为
- 所有操作都在本地完成

---

## 更新日志

### v1.0.0（初始版本）
- 实现基本的接口和页面巡检功能
- 支持自定义告警规则
- 提供定时巡检功能
- 实现巡检报告生成
- 支持页面截图功能

---

## 联系我们

如果您在使用过程中遇到问题或有改进建议，请通过以下方式联系：

- **问题反馈**：[GitHub Issues](https://github.com/83909339/web-inspection/issues)
- **功能建议**：[GitHub Discussions](https://github.com/83909339/web-inspection/discussions)
- **技术交流**：[微信群/QQ群]

感谢您使用Web系统巡检助手！ 